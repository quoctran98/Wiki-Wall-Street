{% extends "base.html" %}

{% block content %}

<div class="gets-blurred">

<div class="alert alert-info" role="alert">
  Hi, I've deployed a new database to hopefully increase speeds!
  However, this means that all of your accounts and games have been deleted.
  Please sign up again and create/join new games! (May 14th, 2020 @ 3:00 PM PDT)
</div>

<!-- GAME EXPLANATION -->
<h2>What is this game?</h2>

<p>
  I keep calling this <b>"the stock market game but for Wikipedia articles"</b>
  but it turns out that not a lot of people know what 
  <a href="https://www.marketwatch.com/games" target="_blank" rel="noopener noreferrer">the stock market game</a> is
  -- it's a game where you have fake money that you can use to buy and sell fake stocks,
  which track the value of real stocks. I played it in twelfth grade for a week as the only part of
  my "economics unit" in my history class, which is why I'm bad with money 
  and spending like $15 a month to host this thing.
</p>
<p>
  Here, you have fake money to <b>buy and sell Wikipedia article "stocks"</b>
  -- the value of the stocks is based on the number of <b>page views</b> that the article gets that day.
  If you're able to <b>predict trends in the popularity</b> of Wikipedia articles, you'll make more (fake) money!
</p>
<p>
  Oh also, <b>Wikipedia only updates their pageviews data once a day.</b>
   I'm not quite sure when, but it seems like it happens between 6PM and 10PM Pacific Time.
   It's also not super consistent and not all pageviews data are updated at the same time!
</p>

<!-- SHOW EITHER LOGIN/SIGNUP BUTTONS OR THE GAME TABLE -->
{% if not current_user.is_authenticated %}

  <p>
    <a href="{{ url_for('auth.login') }}" class="btn btn-primary">Login</a>
    <a href="{{ url_for('auth.signup') }}" class="btn btn-primary">Sign Up</a>
  </p>

{% else %}

  {% if current_user.joined_games|length == 0 %}
    <h3>
      You're not in any games! Create a new game or join a public game to get started!
    </h3>

    <p>
      <button id="new-game-button" class="btn btn-primary">Create a New Game</button>
      <button id="join-game-button" class="btn btn-primary">Join a Private Game</button>
    </p>
  
    <hr>
  {% else %}

  <div>

    <hr>

    <h2>Your Games!</h2>
    <table class="table table-striped" id="joined-games-table">
      <tr>
        <th>Game Name</th>
        <th>Players</th>
        <th>Daily Change</th>
        <th></th>
      </tr>
      <tr id="joined-games-loading">
        <th>Loading <img class="inline-image" src="{{url_for('static', filename='img/loading.gif')}}" alt="Loading..."></th>
        <th></th>
        <th></th>
        <th></th>
      </tr>
    </table>
  </div>

  <p>
    <button id="new-game-button" class="btn btn-primary">Create a New Game</button>
    <button id="join-game-button" class="btn btn-primary">Join a Private Game</button>
  </p>

  <hr>

  {% endif %}

  <div>
    <h2>Public Games!</h2>
    <table class="table table-striped" id="public-games-table">
      <tr>
        <th>Game Name</th>
        <th>Players</th>
        <th></th>
      </tr>
    </table>
  </div>

  <script src="{{url_for('static', filename='js/home-game-table.js')}}"></script>

{% endif %}

</div>

<!-- NEW GAME MODAL -->
<div class="modal" id="new-game-modal">
  <div class="modal-dialog" role="document">
  <div class="modal-content">

  <!-- MODAL HEADER -->
  <div class="modal-header">
      <h5 class="modal-title">CREATE NEW GAME!</h5>

      <!-- CLOSE BUTTON -->
      <button type="button" class="close" id="new-game-modal-close" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
  </div>

  <!-- MODAL BODY -->
  <div class="modal-body">
      <form action="{{ url_for('game.create_game') }}" method="POST" id="new-game-modal-form">
          <input type="hidden" name="user_id" value="{{ current_user.id }}">

          <label for="new-game-modal-game-name">Game Name</label>
          <div class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
              <input class="form-control" type="text" name="game_name" placeholder="New Game" autofocus="" id="new-game-modal-game-name">
          </div>
          
          <label for="new-game-modal-starting-cash">Starting Cash</label>
          <div class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
              <input class="form-control" type="number" name="starting_cash" id="new-game-modal-starting-cash" value="1000000">
          </div>

          <label for="new-game-modal-views-limit">Pageviews Lower Limit</label>
          <div class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
              <input class="form-control" type="number" name="views_limit" id="new-game-modal-views-limit" min="1" value="10">
          </div>

          <hr>
          
          <h6> Show Other Players':</h6>

          <div class="checkbox">
              <label><input type="checkbox" name="show_cash"> Cash</label>
          </div>

          <div class="checkbox">
              <label><input type="checkbox" name="show_articles" id="new-game-show-articles"> Articles Owned</label>
          </div>

          <div class="checkbox">
              <label >
                  <input type="checkbox" name="show_number" id="new-game-show-number" disabled="true">
                  <span style="color: #E5E5E5;" id="new-game-show-number-label"> Number of Each Article</span>
              </label>
          </div>

          <hr>

          <div class="checkbox">
              <label><input type="checkbox" name="public_game"> Make Game Public</label>
          </div>
    </form>
  </div>
  
  <!-- MODAL FOOTER -->
  <div class="modal-footer">
      <button type="button" class="btn btn-secondary" id="new-game-modal-cancel">Cancel</button>
      <button type="submit" class="btn btn-primary" id="new-game-modal-create" form="new-game-modal-form" disabled="true">Create</button>
  </div>

  </div>
  </div>
</div>

<!-- JOIN GAME MODAL -->
<div class="modal" id="join-game-modal">
  <div class="modal-dialog" role="document">
  <div class="modal-content">

  <!-- MODAL HEADER -->
  <div class="modal-header">
      <h5 class="modal-title">JOIN GAME!</h5>

      <!-- CLOSE BUTTON -->
      <button type="button" class="close" id="join-game-modal-close" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
  </div>

  <!-- MODAL BODY -->
  <div class="modal-body">
      <form action="{{ url_for('game.join_game') }}" method="POST" id="join-game-modal-form">
          <input type="hidden" name="user_id" value="{{ current_user.id }}">
          <input type="text" name="game_id" id="join-game-modal-game-id" placeholder="Game ID">
          <button id="join-game-modal-search" type="button" class="btn btn-primary">Search</button>
      </form>

      <div id="join-game-modal-info">
          <p>Enter a game ID!</p>
      </div>
  </div>
  
  <!-- MODAL FOOTER -->
  <div class="modal-footer">
      <button type="button" class="btn btn-secondary" id="join-game-modal-cancel">Cancel</button>
      <button type="submit" class="btn btn-primary" id="join-game-modal-join" form="join-game-modal-form" disabled="true">Join</button>
  </div>

  </div>
  </div>
</div>

<script src="{{url_for('static', filename='js/home-game-modals.js')}}"></script>

{% endblock %}
